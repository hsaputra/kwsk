# Kwsk (Knative OpenWhisk)

## Prerequisites

You'll need a recent [`go`](https://golang.org/doc/install) and
[`dep`](https://github.com/golang/dep). You'll also want this repository
checked somewhere under `$GOPATH/src`.

## Running the server

Change the Istio value below to the appropriate value for your
environment for the istio-ingress service. It's only needed when
invoking actions.

    dep ensure
    go run ./cmd/kwsk-server/main.go --port 8080 --istio 192.168.124.97:32000

## Testing the server

No automated testing yet, but you can hit the thing via curl like:

    curl http://127.0.0.1:8080/api/v1/namespaces/foo/actions

Or via the `wsk` CLI like:

    wsk property set --apihost "http://127.0.0.1:8080"
    echo -e "function main() {\n  return {payload: 'Hello world'};\n}" > hello.js
    wsk action create hello hello.js
    wsk action list
    wsk action get hello
    wsk action create hello-container --docker busybox
    wsk action get hello-container
    wsk action invoke hello

## Implementing the server

The server just contains a but of stubs and unimplemented code right
now. Read through the [go-swagger docs](https://goswagger.io/generate/server.html)
to see how to get started with actual implementations.

The handlers for each API call have autogenerated stubs in
[restapi/configure_kwsk.go](restapi/configure_kwsk.go). Work has
started to move out implementions for each type into their own file,
such as
[restapi/configure_kwsk_actions.go](restapi/configure_kwsk_actions.go).

The parameters, responses, etc for all actions are strongly typed. You
can view the types and their interfaces at
[restapi/operations/](restapi/operations/).

## Generating the server

This server was generated using [go-swagger](https://goswagger.io/)
with the command:

    swagger generate server -A Kwsk -P models.Principal -f apiv1swagger.json
